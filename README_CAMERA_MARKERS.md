# Camera Marker System (Editor-Controlled Zoom + Pan)

This project now supports **timeline camera markers** so you can author dramatic zooms/pans at exact musical times inside the editor.

## What it does

- Adds a new marker type: `camera`.
- Each camera marker stores:
  - `t` (time in seconds)
  - `zoom`
  - `pan_x`
  - `pan_y`
  - `ease` (`smooth`, `linear`, `hold`)
- Runtime camera movement is generated by interpolating between nearby camera markers.
- Camera marker zoom stacks with your existing beat pulse zoom.

---

## Editor Workflow

1. Enter editor mode and switch to **Marker tool** (`M`).
2. Place markers on the timeline:
   - `Alt + LMB` = create a **camera marker**.
   - `LMB` on a marker = select it.
   - `LMB-drag` = retime it.
3. With a camera marker selected:
   - `Q / E` = zoom down/up.
   - Arrow keys = pan X/Y.
   - `Shift + Arrows` = larger pan steps.
   - `C / V` = cycle easing mode (`smooth -> linear -> hold`).
   - `R` = reset camera marker values to neutral.
4. Save markers with `Ctrl+S` and load with `Ctrl+L`.

> Tip: If you already have a pause marker selected, press `U` to convert it into a camera marker.

---

## How interpolation works

At runtime, the camera system reads all `camera` markers from `global.markers`, sorts them by time, and builds `global.camera_events`.

For current time `t`:

- If `t` is between two markers, values interpolate from previous to next.
- If no previous marker exists yet, interpolation starts from neutral camera (`zoom=1`, `pan_x=0`, `pan_y=0`) toward the first marker.
- If past the final marker, the final marker values are held.

Easing behavior uses the **next marker's** `ease` mode:

- `smooth`: smoothstep blend.
- `linear`: straight lerp.
- `hold`: step hold until marker time, then snap.

---

## Data format example

```json
{
  "t": 42.5,
  "type": "camera",
  "zoom": 1.2,
  "pan_x": 140,
  "pan_y": -40,
  "ease": "smooth",
  "caption": "CAM: z1.20 x140 y-40 [smooth]"
}
```

---

## Notes

- Camera markers are saved/loaded through the same marker JSON pipeline as story/difficulty markers.
- Camera marker values are clamped for safety.
- Existing marker types (`pause`, `difficulty`, `spawn`, `pickup`) continue to work normally.
